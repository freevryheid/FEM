      SUBROUTINE ASGRAD(KLD,VDIMP,KLOCE,VCORE,VPRNE,VPREE,KNE,VKE,VFE,
     1  VKGS,VKGD,VKGI,VFG,VDLE,VRES)
C=====================================================================
C      pg 410
C=====================================================================
C
C     TO EVALUATE AND PRINT GRADIENTS (STRESSES) AT ELEMENT G.P.
C        (ELEMENT FUNCTION 8)
C===============================================================
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/ELEM/NELT,NNEL,NTPE,NGRE,ME,NIDENT
      COMMON/ASSE/NSYM
      COMMON/RESO/NEQ
      COMMON/RGDT/IEL,ITPE,ITPE1,IGRE,IDLE,ICE,IPRNE,IPREE,INEL,IDEG,IPG
     1  ,ICOD
      COMMON/ES/M,MR,MP,M1,M2
      DIMENSION KLD(*),VDIMP(*),KLOCE(*),VCORE(*),VPRNE(*),VPREE(*),
     1  KNE(*),VKE(*),VFE(*),VKGS(*),VKGD(*),VKGI(*),VFG(*),VDLE(*),
     2  VRES(*)
C-----    REWIND ELEMENTS FILE (M2)
      REWIND M2
C-----    LOOP OVER THE ELEMENTS
      DO 20 IE=1,NELT
C-----    READ THE ELEMENT
      CALL RDELEM(M2,KLOCE,VCORE,VPRNE,VPREE,KNE)
C-----    EVALUATE INTERPOLATION FUNCTION IF REQUIRED
      IF(ITPE.EQ.ITPE1) GO TO 10
      ICOD=2
      CALL ELEMLB(VCORE,VPRNE,VPREE,VDLE,VKE,VFE)
C-----    FIND ELEMENT D.O.F.
10    CALL DLELM(KLOCE,VFG,VDIMP,VDLE)
C         COMPUTE AND PRINT STRESSES OR GRADIENTS
      ICOD=8
      CALL ELEMLB(VCORE,VPRNE,VPREE,VDLE,VKE,VFE)
20    ITPE1=ITPE
      RETURN
      END